# Development Dockerfile for Open Source Template Generator

FROM golang:1.24-alpine

# Install development dependencies
RUN apk add --no-cache \
    git \
    ca-certificates \
    tzdata \
    make \
    bash \
    curl \
    wget \
    tar \
    gzip \
    && rm -rf /var/cache/apk/*

# Install development tools
RUN go install github.com/golangci/golangci-lint/cmd/golangci-lint@v1.64.2 && \
    go install github.com/air-verse/air@v1.52.3 && \
    go install gotest.tools/gotestsum@v1.11.0

# Create non-root user
RUN addgroup -g 1000 developer && \
    adduser -D -s /bin/bash -u 1000 -G developer developer

# Set working directory
WORKDIR /app

# Create necessary directories
RUN mkdir -p /workspace /home/developer/.config/generator /home/developer/.cache/generator && \
    chown -R developer:developer /app /workspace /home/developer

# Switch to non-root user
USER developer

# Set environment variables
ENV GOOS=linux
ENV GOARCH=amd64
ENV CGO_ENABLED=0
ENV GENERATOR_LOG_LEVEL=debug

# Default command
CMD ["bash"]