name: Security Vulnerability
description: Report a security vulnerability (use private reporting when possible)
title: "[SECURITY]: "
labels: ["security", "high-priority"]
assignees:
  - {{.Organization}}/security-team
body:
  - type: markdown
    attributes:
      value: |
        ⚠️ **IMPORTANT SECURITY NOTICE** ⚠️
        
        **Please do not report security vulnerabilities in public issues!**
        
        For security vulnerabilities, please use GitHub's private vulnerability reporting feature or email security@{{.Organization}}.com
        
        This template should only be used for:
        - Security-related feature requests
        - Security hardening suggestions
        - Non-sensitive security discussions
        
        If you have found an actual vulnerability, please report it privately through:
        1. GitHub Security Advisories (preferred)
        2. Email: security@{{.Organization}}.com
        3. See our [Security Policy](../SECURITY.md) for more details

  - type: checkboxes
    id: confirmation
    attributes:
      label: Confirmation
      description: Please confirm this is not an actual vulnerability report
      options:
        - label: I confirm this is NOT reporting an actual security vulnerability
          required: true
        - label: I have read the Security Policy and understand how to report vulnerabilities privately
          required: true
        - label: This is a security-related enhancement or discussion only
          required: true

  - type: dropdown
    id: type
    attributes:
      label: Security Issue Type
      description: What type of security-related issue is this?
      options:
        - Security Enhancement Request
        - Security Hardening Suggestion
        - Security Documentation Improvement
        - Security Tool Integration
        - Security Best Practices Discussion
        - Security Audit Request
        - Compliance Requirement
    validations:
      required: true

  - type: dropdown
    id: component
    attributes:
      label: Affected Component
      description: Which component does this security issue relate to?
      options:
        {{if .Components.Frontend.MainApp}}- Frontend - Main App{{end}}
        {{if .Components.Frontend.Home}}- Frontend - Home{{end}}
        {{if .Components.Frontend.Admin}}- Frontend - Admin{{end}}
        - Backend - API Server
        {{if .Components.Mobile.Android}}- Mobile - Android{{end}}
        {{if .Components.Mobile.IOS}}- Mobile - iOS{{end}}
        {{if .Components.Infrastructure.Docker}}- Infrastructure - Docker{{end}}
        {{if .Components.Infrastructure.Kubernetes}}- Infrastructure - Kubernetes{{end}}
        {{if .Components.Infrastructure.Terraform}}- Infrastructure - Terraform{{end}}
        - CI/CD Pipeline
        - Dependencies
        - Documentation
        - Multiple Components
        - Project-wide
    validations:
      required: true

  - type: dropdown
    id: priority
    attributes:
      label: Priority Level
      description: How important is this security enhancement?
      options:
        - Critical (Addresses immediate security concerns)
        - High (Important for security posture)
        - Medium (Good security practice)
        - Low (Nice to have security improvement)
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: Security Issue Description
      description: Describe the security enhancement or concern
      placeholder: |
        Provide a clear description of the security enhancement you're suggesting or the security concern you want to discuss.
        
        Example: "The current authentication system could be enhanced by adding..."
    validations:
      required: true

  - type: textarea
    id: current_state
    attributes:
      label: Current Security State
      description: Describe the current security implementation or lack thereof
      placeholder: |
        Describe how security is currently handled in the relevant component or area.

  - type: textarea
    id: proposed_improvement
    attributes:
      label: Proposed Security Improvement
      description: Describe your proposed security enhancement
      placeholder: |
        Describe in detail what security improvements you're suggesting.
        
        Include:
        - What should be implemented
        - How it would improve security
        - Any specific technologies or approaches

  - type: textarea
    id: security_benefits
    attributes:
      label: Security Benefits
      description: What security benefits would this improvement provide?
      placeholder: |
        Example:
        - Prevents [specific attack type]
        - Improves data protection by [method]
        - Enhances user privacy through [mechanism]
        - Reduces attack surface by [approach]

  - type: textarea
    id: compliance
    attributes:
      label: Compliance and Standards
      description: Does this relate to any compliance requirements or security standards?
      placeholder: |
        Example:
        - OWASP Top 10 compliance
        - SOC 2 requirements
        - GDPR compliance
        - Industry-specific regulations
        - Security frameworks (NIST, ISO 27001, etc.)

  - type: textarea
    id: implementation_suggestions
    attributes:
      label: Implementation Suggestions
      description: Do you have suggestions for how to implement this security improvement?
      placeholder: |
        Example:
        - Specific libraries or tools to use
        - Configuration changes needed
        - Code patterns to follow
        - Integration approaches

  - type: textarea
    id: security_tools
    attributes:
      label: Security Tools and Testing
      description: What security tools or testing methods should be used?
      placeholder: |
        Example:
        - Static analysis tools (CodeQL, SonarQube)
        - Dynamic testing tools (OWASP ZAP, Burp Suite)
        - Dependency scanning (Snyk, Dependabot)
        - Container scanning (Trivy, Clair)
        - Penetration testing approaches

  - type: checkboxes
    id: security_categories
    attributes:
      label: Security Categories
      description: Which security categories does this enhancement address?
      options:
        - label: Authentication and Authorization
        - label: Data Protection and Encryption
        - label: Input Validation and Sanitization
        - label: Network Security
        - label: Container and Infrastructure Security
        - label: Dependency and Supply Chain Security
        - label: Logging and Monitoring
        - label: Incident Response
        - label: Privacy Protection
        - label: Secure Development Practices

  - type: textarea
    id: risk_assessment
    attributes:
      label: Risk Assessment
      description: What risks does this enhancement help mitigate?
      placeholder: |
        Describe the security risks that would be reduced by implementing this enhancement.
        
        Include:
        - Threat actors that would be deterred
        - Attack vectors that would be blocked
        - Data that would be better protected

  - type: textarea
    id: references
    attributes:
      label: References and Resources
      description: Provide any relevant security references, standards, or resources
      placeholder: |
        Example:
        - OWASP guidelines
        - Security research papers
        - Industry best practices
        - Relevant CVEs or security advisories
        - Security tool documentation

  - type: dropdown
    id: willing_to_help
    attributes:
      label: Contribution
      description: Are you willing to help implement this security enhancement?
      options:
        - "Yes, I can implement this enhancement"
        - "Yes, I can help with security testing"
        - "Yes, I can help with documentation"
        - "Yes, I can provide security expertise"
        - "No, I cannot contribute at this time"
    validations:
      required: true

  - type: textarea
    id: additional_context
    attributes:
      label: Additional Context
      description: Any additional security-related context or information
      placeholder: |
        Any other information that might be relevant to this security enhancement.